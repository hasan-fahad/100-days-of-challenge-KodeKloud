# Day 006: Setup a Cron Job

This guide explains how to set up a cron job on CentOS for Nautilus app servers to automate routine tasks.

---

## üéØ Objective

Deploy a test cron job that runs every 5 minutes and writes 'hello' to `/tmp/cron_text` for the root user.

---

## üîß Steps

### 1. Login into the server

```bash
ssh user@app-server-ip
```

### 2. Install `cronie` package

```bash
sudo yum install cronie -y
```

### 3. Start and enable `crond`

```bash
sudo systemctl enable crond
sudo systemctl start crond
sudo systemctl status crond
```

### 4. Create cron schedule

```bash
sudo crontab -e
```

Add the following line:

```bash
*/5 * * * * echo hello > /tmp/cron_text
```

### 5. Verify crontab

```bash
sudo crontab -l
```

Wait 5 minutes and check `/tmp/cron_text`:

```bash
cat /tmp/cron_text
```

---

## üìú Automation Script

```bash
#!/bin/sh

# setup_cron_job.sh
# Script to setup cron job on CentOS for Nautilus app servers

set -e  # Exit on any error

echo "=== Setting up Cron Job on CentOS ==="

# Step 1: Install cronie package
if ! rpm -q cronie &>/dev/null; then
    sudo yum install cronie -y
    echo "‚úì cronie package installed successfully"
else
    echo "‚úì cronie package already installed"
fi

# Step 2: Start and enable crond service
sudo systemctl start crond
sudo systemctl enable crond

# Verify service
if systemctl is-active --quiet crond; then
    echo "‚úì crond service is running"
else
    echo "‚úó Failed to start crond service"; exit 1
fi

# Step 3: Add cron job for root user
CRON_JOB="*/5 * * * * echo hello > /tmp/cron_text"
if sudo crontab -l 2>/dev/null | grep -q "echo hello > /tmp/cron_text"; then
    echo "‚úì Cron job already exists"
else
    (sudo crontab -l 2>/dev/null || true; echo "$CRON_JOB") | sudo crontab -
    echo "‚úì Cron job added successfully"
fi

# Step 4: Verify setup
sudo crontab -l

echo "=== Setup Complete ==="
echo "To monitor: sudo tail -f /var/log/cron"
echo "To check output: cat /tmp/cron_text (after 5+ minutes)"
```

---

## ‚öôÔ∏è Cron Job Scheduling Basics

* **Format**: `minute hour day month weekday command`
* **Ranges**: 0-59 (min), 0-23 (hour), 1-31 (day), 1-12 (month), 0-7 (weekday)
* **Special Characters**: `*` (any), `,` (list), `-` (range), `/` (step)
* **Example**: `0 2 * * *` ‚Üí daily at 2 AM

### Cron Types

* **User Crontab**: `crontab -e` (per-user)
* **System Crontab**: `/etc/crontab`
* **Cron Directories**: `/etc/cron.d/`, `/etc/cron.daily/`

---

## ‚úÖ Best Practices

* Use **absolute paths** in cron jobs
* Set environment variables: PATH, SHELL, MAILTO
* Redirect output to logs
* Test commands manually before scheduling

---

## üõ†Ô∏è Troubleshooting

* Check logs: `/var/log/cron`
* Cron runs in minimal environment
* Ensure user has execute permissions

---

![Screenshot](attachment\:c3bb5f94-5cd7-4161-a1df-8b7af7fe1fcf\:Screenshot_2025-12-09_at_2.51.42_PM.png)
