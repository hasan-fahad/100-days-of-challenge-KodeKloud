# Day 010: Website Media Backup Automation

The production support team of **xFusionCorp Industries** needs a Bash script to automate website media backups from **App Server 3** and securely store them on the **Nautilus Backup Server**.

---

## ğŸ¯ Objective

Create a Bash script named `media_backup.sh` that:

* Compresses the `/var/www/html/media` directory
* Saves the archive locally in `/backup/`
* Copies the archive to the Nautilus Backup Server
* Uses **password-less SSH authentication**
* Can be executed by the respective server user
* Does **not** use `sudo` inside the script

The script must be placed under:

```
/scripts/media_backup.sh
```

---

## ğŸ“‹ Prerequisites

* `zip` package installed on App Server 3
* SSH key-based authentication set up between App Server 3 and Backup Server
* `/backup` and `/scripts` directories exist

---

## ğŸ”§ Setup Steps

### 1ï¸âƒ£ Login to App Server 3 and Generate SSH Key

```bash
ssh-keygen -t rsa -b 2048
```

### 2ï¸âƒ£ Copy Public Key to Backup Server

```bash
ssh-copy-id clint@stbkp01
```

This ensures password-less file transfer.

---

## ğŸ“ Backup Script

Create the script at `/scripts/media_backup.sh`:

```bash
#!/bin/sh

zip -r /backup/xfusioncorp_media.zip /var/www/html/media
scp /backup/xfusioncorp_media.zip clint@stbkp01:/backup/
```

---

## ğŸ”‘ Permissions

Make the script executable:

```bash
chmod +x /scripts/media_backup.sh
```

Verify permissions:

```bash
ls -l /scripts/media_backup.sh
```

Expected output:

```
-rwxr-xr-x 1 banner banner 126 Dec 13 05:06 media_backup.sh
```

---

## ğŸ” SSH Access for Other Servers (Optional)

If the script needs to be triggered remotely:

```bash
ssh-copy-id tony@stapp01
```

---

## ğŸ“¦ Verification

* Confirm ZIP file creation:

```bash
ls -lh /backup/xfusioncorp_media.zip
```

* Confirm file exists on Backup Server:

```bash
ssh clint@stbkp01 ls -lh /backup/
```

---

## ğŸ“˜ Good to Know

### Bash Scripting Best Practices

* Use shebang: `#!/bin/bash` or `#!/bin/sh`
* Prefer `set -e` for error handling
* Quote variables to avoid word splitting
* Use functions for reusability

### Backup Strategies

* Full, Incremental, Differential backups
* Compress archives to save space
* Validate backups periodically

### Archive Commands

* `zip -r archive.zip dir/`
* `tar -czf archive.tar.gz dir/`
* Exclude logs or temp files when needed

### Remote Copy Tools

* `scp` â€“ simple secure copy
* `rsync` â€“ efficient and resumable
* `sftp` â€“ interactive transfers

---

## ğŸ“¸ Screenshots

![Media Backup Script](attachment\:a0cc0c58-7834-44bb-9200-7305efe3c5a5\:Screenshot_2025-12-13_at_10.51.14_AM.png)

![Backup Server Copy](attachment:12af7203-7d2d-4bf1-9010-3380ebef8066\:Screenshot_2025-12-13_at_11.06.51_AM.png)

---

âœ… **Result**: Automated, secure, password-less website media backups are now operational.
